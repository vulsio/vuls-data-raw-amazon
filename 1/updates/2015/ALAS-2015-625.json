{
	"ID": "ALAS-2015-625",
	"Author": "linux-security@amazon.com",
	"From": "linux-security@amazon.com",
	"Status": "final",
	"Type": "security",
	"Version": "1.4",
	"Title": "Amazon Linux AMI 2014.03 - ALAS-2015-625: medium priority package update for openssh",
	"Issued": {
		"Date": "2015-12-14 10:00:00"
	},
	"Updated": {
		"Date": "2015-12-13 14:24:00"
	},
	"Severity": "medium",
	"Description": "Package updates are available for Amazon Linux AMI that fix the following vulnerabilities:\nCVE-2015-6564:\n\tUse-after-free vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH before 7.0 on non-OpenBSD platforms might allow local users to gain privileges by leveraging control of the sshd uid to send an unexpectedly early MONITOR_REQ_PAM_FREE_CTX request.\nA use-after-free flaw was found in OpenSSH. An attacker able to fully compromise a non-privileged pre-authentication process using a different flaw could possibly cause sshd to crash or execute arbitrary code with root privileges.\n1252852: \nCVE-2015-6564 openssh: Use-after-free bug related to PAM support\n\nCVE-2015-6563:\n\tThe monitor component in sshd in OpenSSH before 7.0 on non-OpenBSD platforms accepts extraneous username data in MONITOR_REQ_PAM_INIT_CTX requests, which allows local users to conduct impersonation attacks by leveraging any SSH login access in conjunction with control of the sshd uid to send a crafted MONITOR_REQ_PWNAM request, related to monitor.c and monitor_wrap.c.\nA flaw was found in the way OpenSSH handled PAM authentication when using privilege separation. An attacker with valid credentials on the system and able to fully compromise a non-privileged pre-authentication process using a different flaw could use this flaw to authenticate as other users.\n1252844: \nCVE-2015-6563 openssh: Privilege separation weakness related to PAM support\n\nCVE-2015-5600:\n\tIt was discovered that the OpenSSH sshd daemon did not check the list of keyboard-interactive authentication methods for duplicates. A remote attacker could use this flaw to bypass the MaxAuthTries limit, making it easier to perform password guessing attacks.\n1245969: \nCVE-2015-5600 openssh: MaxAuthTries limit bypass via duplicates in KbdInteractiveDevices\n",
	"References": {
		"Reference": [
			{
				"Href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5600",
				"ID": "CVE-2015-5600",
				"Title": "",
				"Type": "cve"
			},
			{
				"Href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6563",
				"ID": "CVE-2015-6563",
				"Title": "",
				"Type": "cve"
			},
			{
				"Href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6564",
				"ID": "CVE-2015-6564",
				"Title": "",
				"Type": "cve"
			}
		]
	},
	"Pkglist": {
		"Collection": {
			"Short": "amazon-linux-ami",
			"Name": "Amazon Linux AMI",
			"Package": [
				{
					"Arch": "x86_64",
					"Epoch": "0",
					"Name": "openssh",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-6.6.1p1-22.58.amzn1.x86_64.rpm"
				},
				{
					"Arch": "x86_64",
					"Epoch": "0",
					"Name": "openssh-clients",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-clients-6.6.1p1-22.58.amzn1.x86_64.rpm"
				},
				{
					"Arch": "x86_64",
					"Epoch": "0",
					"Name": "pam_ssh_agent_auth",
					"Release": "9.22.58.amzn1",
					"Version": "0.9.3",
					"Filename": "Packages/pam_ssh_agent_auth-0.9.3-9.22.58.amzn1.x86_64.rpm"
				},
				{
					"Arch": "x86_64",
					"Epoch": "0",
					"Name": "openssh-server",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-server-6.6.1p1-22.58.amzn1.x86_64.rpm"
				},
				{
					"Arch": "x86_64",
					"Epoch": "0",
					"Name": "openssh-debuginfo",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-debuginfo-6.6.1p1-22.58.amzn1.x86_64.rpm"
				},
				{
					"Arch": "x86_64",
					"Epoch": "0",
					"Name": "openssh-keycat",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-keycat-6.6.1p1-22.58.amzn1.x86_64.rpm"
				},
				{
					"Arch": "x86_64",
					"Epoch": "0",
					"Name": "openssh-ldap",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-ldap-6.6.1p1-22.58.amzn1.x86_64.rpm"
				},
				{
					"Arch": "i686",
					"Epoch": "0",
					"Name": "openssh",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-6.6.1p1-22.58.amzn1.i686.rpm"
				},
				{
					"Arch": "i686",
					"Epoch": "0",
					"Name": "openssh-server",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-server-6.6.1p1-22.58.amzn1.i686.rpm"
				},
				{
					"Arch": "i686",
					"Epoch": "0",
					"Name": "pam_ssh_agent_auth",
					"Release": "9.22.58.amzn1",
					"Version": "0.9.3",
					"Filename": "Packages/pam_ssh_agent_auth-0.9.3-9.22.58.amzn1.i686.rpm"
				},
				{
					"Arch": "i686",
					"Epoch": "0",
					"Name": "openssh-keycat",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-keycat-6.6.1p1-22.58.amzn1.i686.rpm"
				},
				{
					"Arch": "i686",
					"Epoch": "0",
					"Name": "openssh-ldap",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-ldap-6.6.1p1-22.58.amzn1.i686.rpm"
				},
				{
					"Arch": "i686",
					"Epoch": "0",
					"Name": "openssh-debuginfo",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-debuginfo-6.6.1p1-22.58.amzn1.i686.rpm"
				},
				{
					"Arch": "i686",
					"Epoch": "0",
					"Name": "openssh-clients",
					"Release": "22.58.amzn1",
					"Version": "6.6.1p1",
					"Filename": "Packages/openssh-clients-6.6.1p1-22.58.amzn1.i686.rpm"
				}
			]
		}
	}
}
